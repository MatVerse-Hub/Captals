name: MatVerse Zero-Cost Bootstrap
version: 1.0.0
description: Inicializa ecossistema MatVerse completo em modo zero-cost

steps:
  - name: "ğŸ” Detectar ambiente"
    run: |
      echo "OS: $(uname -s)"
      echo "Arch: $(uname -m)"
      echo "PWD: $(pwd)"

  - name: "ğŸ“¦ Instalar dependÃªncias core"
    run: |
      if command -v apt-get &> /dev/null; then
        sudo apt-get update -qq
        sudo apt-get install -y curl unzip docker.io python3-pip
      elif command -v brew &> /dev/null; then
        brew install curl unzip docker python3
      fi

  - name: "ğŸ§  Inicializar Ollama + DeepSeek"
    run: |
      if ! command -v ollama &> /dev/null; then
        curl -L https://github.com/jmorganca/ollama/releases/download/v0.3.0/ollama-linux-amd64 -o /tmp/ollama
        sudo install -m 755 /tmp/ollama /usr/local/bin/ollama
      fi
      ollama serve &
      sleep 5
      ollama pull deepseek-coder:1.3b-q4_K_M
      echo "âœ“ LLM local operacional (zero-cost)"

  - name: "ğŸ³ Subir Qdrant (vector store)"
    run: |
      docker rm -f qdrant 2>/dev/null || true
      docker run -d --name qdrant \
        -p 6333:6333 \
        -v $(pwd)/qdrant:/qdrant/storage \
        qdrant/qdrant
      echo "âœ“ Qdrant online"

  - name: "â›“ï¸ Iniciar Anvil (blockchain 0-gwei)"
    run: |
      if ! command -v anvil &> /dev/null; then
        curl -L https://foundry.paradigm.xyz | bash
        source ~/.bashrc
        foundryup install
      fi
      anvil --accounts 20 --gas-price 0 --gas-limit 30000000 &> anvil.log &
      echo "âœ“ Blockchain local (gas 0)"

  - name: "â˜ï¸ Montar TeraBox + GDrive"
    run: |
      # TeraBox via rclone
      if ! command -v rclone &> /dev/null; then
        curl https://rclone.org/install.sh | sudo bash
      fi

      mkdir -p ~/.config/rclone
      cat > ~/.config/rclone/rclone.conf <<EOF
      [terabox]
      type = webdav
      url = https://dav.terabox.com
      vendor = other
      user = ${TERABOX_USER}
      pass = $(rclone obscure ${TERABOX_PASS})

      [gdrive]
      type = drive
      scope = drive
      token = ${GDRIVE_TOKEN}
      EOF

      mkdir -p /mnt/terabox /mnt/gdrive
      rclone mount terabox: /mnt/terabox --daemon --vfs-cache-mode writes
      rclone mount gdrive: /mnt/gdrive --daemon --vfs-cache-mode writes
      echo "âœ“ Dual-Brain Storage montado"

  - name: "ğŸ‘ï¸ Iniciar Dual-Brain Watcher"
    run: |
      pip3 install -q watchdog openai requests
      python3 watcher/dual_brain_sync.py &> watcher.log &
      echo "âœ“ Watcher monitorando TeraBox + GDrive"

  - name: "ğŸ” Inicializar LUA-AutoHeal"
    run: |
      cd xi-lua
      pip3 install -q -r requirements.txt
      ./Î¾-lua init
      ./Î¾-lua status
      echo "âœ“ AutoHeal (8 camadas) ativo"

  - name: "ğŸ¤– Ativar IA-MetaMask"
    run: |
      npm install -g @anthropic-ai/claude-code
      node ia-metamask.js &> metamask.log &
      echo "âœ“ IA-MetaMask aguardando QR"

  - name: "ğŸ’¾ Build MatVerse-Zero HTML"
    run: |
      npm install
      npm run build
      echo "âœ“ Build completo"

  - name: "ğŸ“Š Dashboard de Status"
    run: |
      echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
      echo "ğŸ’ MatVerse Zero-Cost - ONLINE"
      echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
      echo "ğŸ§  LLM: ollama (deepseek-coder)"
      echo "ğŸ’¾ Vector: Qdrant (localhost:6333)"
      echo "â›“ï¸ Chain: Anvil (gas 0)"
      echo "â˜ï¸ Storage: TeraBox + GDrive"
      echo "ğŸ” Security: LUA-AutoHeal"
      echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
      ./Î¾-lua status
      echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

env:
  - TERABOX_USER
  - TERABOX_PASS
  - GDRIVE_TOKEN
  - OPENAI_KEY
  - ANTHROPIC_KEY
